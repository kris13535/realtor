{"ast":null,"code":"var _jsxFileName = \"/Users/kristina/Desktop/experis/week_9/realtor/src/pages/search/gallery.jsx\";\nimport React from 'react';\nimport Card from \"../../components/card/card.jsx\";\nimport Filters from \"./filters/filters\";\nimport api from \"../../server_api/api\";\n\nclass Gallery extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.data_price_multiplication = price => {\n      if (price && typeof price !== \"number\") {\n        let multiplication_price_max = price.slice(-1);\n\n        if (multiplication_price_max === \"k\") {\n          price = parseInt(price.slice(1)) * 1000;\n        } else if (multiplication_price_max === \"M\") {\n          price = parseInt(price.slice(1)) * 1000000;\n        }\n      }\n\n      return price;\n    };\n\n    this.updateGalleryItems = data => {\n      if (data.minPrice) {\n        data.minPrice = this.data_price_multiplication(data.minPrice);\n      }\n\n      if (data.maxPrice) {\n        data.maxPrice = this.data_price_multiplication(data.maxPrice);\n      }\n\n      this.setState({\n        country: data.country\n      });\n      data = this.dataToString(data);\n      this.setState({\n        filtered: data\n      }, () => this.getdata()); // let {cities, apartments, } = this.state;\n      // let temp = this.state.apartments;\n      // let new_apartments = [];\n      //\n      //\n      // new_apartments = temp.filter(function (apartment) {\n      //                 const city = cities.find(city => city.id === apartment.cityId);\n      //                 const city_name = city.label;\n      //                 if (city_name.toLowerCase().includes(data.city.toLowerCase())){ return apartment}\n      //             });\n      //\n      // if (data.price_min || data.price_max) {\n      //     data.price_min = this.data_price_multiplication(data.price_min);\n      //     data.price_max = this.data_price_multiplication(data.price_max);\n      //\n      //     if (data.price_max || data.price_min) {\n      //         new_apartments = new_apartments.filter(obj => this.checkRange(obj, data.price_min , data.price_max , \"price\"))\n      //     }\n      // }\n      // if (data.bed_min || data.bed_max) {\n      //     new_apartments = new_apartments.filter (obj => this.checkRange(obj, data.bed_min, data.bed_max, \"number_of_beds\"))\n      // }\n      // if (data.room_min || data.room_max) {\n      //     new_apartments = new_apartments.filter(obj => this.checkRange(obj, data.room_min, data.room_max, \"number_of_rooms\"))\n      // }\n      // if (data.no_filters){\n      //         new_apartments = temp;\n      // }\n      // this.setState({filtered:new_apartments})\n    };\n\n    this.state = {\n      apartments: [],\n      filtered: \"\",\n      countries: [],\n      country: \"\",\n      cities: []\n    };\n  }\n\n  componentDidMount() {\n    this.getdata();\n  }\n\n  async getdata() {\n    const data = await api.getfilteredApartments(this.state.filtered);\n    let countries_array = [];\n    let cities_array = [];\n    data.data.apartments.map(item => {\n      return countries_array.push(item.country), cities_array.push(item.city_name);\n    });\n\n    if (this.state.country != \"\") {\n      cities_array.filter(city => city);\n    }\n\n    this.setState({\n      apartments: data.data.apartments,\n      countries: Array.from(new Set(countries_array)),\n      cities: Array.from(new Set(cities_array))\n    });\n  } // checkRange = ( value, min, max, label) => {\n  //     let cur_val = value[label];\n  //     if (label === 'price') {\n  //         cur_val = value[label]*100000;\n  //     }\n  //     min = (min === undefined || min === \"\") ?  0 : min;\n  //     max = (max === undefined || max === \"\") ?  Infinity : max;\n  //\n  //     return (cur_val >= min && cur_val <= max);\n  // };\n  //\n\n\n  dataToString(data) {\n    let str = \"\";\n\n    for (let prop in data) {\n      str += prop + '=';\n      str += data[prop] + '&';\n    }\n\n    return str;\n  }\n\n  render() {\n    const _this$state = this.state,\n          cities = _this$state.cities,\n          apartments = _this$state.apartments;\n\n    const buildSquareDetails = () => {\n      return apartments.map((item, i) => {\n        return React.createElement(Card, Object.assign({}, item, {\n          cities: cities,\n          type: this.props.type,\n          key: i,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }));\n      });\n    };\n\n    return React.createElement(\"div\", {\n      style: {\n        overflow: \"hidden\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(Filters, {\n      updateGalleryItems: this.updateGalleryItems,\n      countries: this.state.countries,\n      cities: this.state.cities,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"row m-0 d-flex justify-content-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, buildSquareDetails()));\n  }\n\n}\n\nexport default Gallery;","map":{"version":3,"sources":["/Users/kristina/Desktop/experis/week_9/realtor/src/pages/search/gallery.jsx"],"names":["React","Card","Filters","api","Gallery","Component","constructor","props","data_price_multiplication","price","multiplication_price_max","slice","parseInt","updateGalleryItems","data","minPrice","maxPrice","setState","country","dataToString","filtered","getdata","state","apartments","countries","cities","componentDidMount","getfilteredApartments","countries_array","cities_array","map","item","push","city_name","filter","city","Array","from","Set","str","prop","render","buildSquareDetails","i","type","overflow"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Card from \"../../components/card/card.jsx\";\nimport Filters from \"./filters/filters\";\nimport api from \"../../server_api/api\";\n\nclass Gallery extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            apartments: [],\n            filtered: \"\",\n            countries: [],\n            country: \"\",\n            cities: [],\n        }\n    };\n\n    componentDidMount(){\n        this.getdata();\n    }\n\n    async getdata(){\n        const data = await api.getfilteredApartments(this.state.filtered);\n\n        let countries_array= [];\n        let cities_array = [];\n        data.data.apartments.map(item => {return countries_array.push(item.country) , cities_array.push(item.city_name) });\n        if(this.state.country != \"\"){\n            cities_array.filter(city => city )\n        }\n\n        this.setState({\n            apartments:data.data.apartments,\n            countries: Array.from(new Set(countries_array)),\n            cities: Array.from(new Set(cities_array)),\n        });\n    }\n\n    // checkRange = ( value, min, max, label) => {\n    //     let cur_val = value[label];\n    //     if (label === 'price') {\n    //         cur_val = value[label]*100000;\n    //     }\n    //     min = (min === undefined || min === \"\") ?  0 : min;\n    //     max = (max === undefined || max === \"\") ?  Infinity : max;\n    //\n    //     return (cur_val >= min && cur_val <= max);\n    // };\n    //\n    data_price_multiplication = (price) => {\n        if (price && typeof price !== \"number\") {\n            let multiplication_price_max = price.slice(-1);\n\n            if (multiplication_price_max === \"k\") {\n                price = parseInt(price.slice(1)) * 1000;\n            } else if (multiplication_price_max === \"M\") {\n                price = parseInt(price.slice(1)) * 1000000;\n            }\n        }\n        return price;\n    };\n\n    dataToString(data) {\n        let str = \"\";\n        for (let prop in data) {\n            str += prop + '=';\n            str += data[prop] + '&'\n        }\n        return str;\n    }\n\n    updateGalleryItems  = (data) => {\n\n       if(data.minPrice){\n           data.minPrice = this.data_price_multiplication(data.minPrice);\n       }\n       if(data.maxPrice){\n            data.maxPrice = this.data_price_multiplication(data.maxPrice);\n       }\n\n       this.setState({country: data.country });\n\n       data = this.dataToString(data);\n\n        this.setState({\n            filtered: data,\n        }, () => this.getdata());\n\n\n\n\n        // let {cities, apartments, } = this.state;\n        // let temp = this.state.apartments;\n        // let new_apartments = [];\n        //\n        //\n        // new_apartments = temp.filter(function (apartment) {\n        //                 const city = cities.find(city => city.id === apartment.cityId);\n        //                 const city_name = city.label;\n        //                 if (city_name.toLowerCase().includes(data.city.toLowerCase())){ return apartment}\n        //             });\n        //\n        // if (data.price_min || data.price_max) {\n        //     data.price_min = this.data_price_multiplication(data.price_min);\n        //     data.price_max = this.data_price_multiplication(data.price_max);\n        //\n        //     if (data.price_max || data.price_min) {\n        //         new_apartments = new_apartments.filter(obj => this.checkRange(obj, data.price_min , data.price_max , \"price\"))\n        //     }\n        // }\n        // if (data.bed_min || data.bed_max) {\n        //     new_apartments = new_apartments.filter (obj => this.checkRange(obj, data.bed_min, data.bed_max, \"number_of_beds\"))\n        // }\n        // if (data.room_min || data.room_max) {\n        //     new_apartments = new_apartments.filter(obj => this.checkRange(obj, data.room_min, data.room_max, \"number_of_rooms\"))\n        // }\n        // if (data.no_filters){\n        //         new_apartments = temp;\n        // }\n\n        // this.setState({filtered:new_apartments})\n    };\n\n\n    render() {\n        const { cities, apartments } = this.state;\n        const buildSquareDetails = () => {\n            return apartments.map((item, i) => {\n                return (\n                    <Card {...item} cities={cities} type={this.props.type} key={i}/>\n                )\n            })\n        };\n\n        return (\n            <div style={{overflow:\"hidden\"}}>\n                <div>\n                    <Filters updateGalleryItems={this.updateGalleryItems} countries={this.state.countries} cities={this.state.cities} />\n                </div>\n\n                <div className={\"row m-0 d-flex justify-content-around\"}>\n                    {buildSquareDetails()}\n                </div>\n            </div>\n        )\n    }\n}\n\n\nexport default Gallery;\n"]},"metadata":{},"sourceType":"module"}